image: ubuntu/jammy
packages:
    - cargo
    - rustfmt
    - clang-format
    - git
    - libwayland-dev
    - libwlroots-dev
    - make
    - pkgconf
    - scdoc
    - wayland-protocols
    - xwayland
sources:
    - https://git.sr.ht/~shinyzenith/NextWM
tasks:
    - install-lang: |
          ZIG_VERSION=0.9.1

          wget -nv https://ziglang.org/download/$ZIG_VERSION/zig-linux-x86_64-$ZIG_VERSION.tar.xz
          tar -xvf zig-linux-x86_64-$ZIG_VERSION.tar.xz
          sudo mv ./zig-linux-x86_64-$ZIG_VERSION/zig /usr/bin
          sudo mv ./zig-linux-x86_64-$ZIG_VERSION/lib /usr/lib/zig

    - build: |
          cd NextWM
          make

    - build-rs: |
          cd NextWM
          zig build -Dnextctl-rs

    - fmt: |
          cd NextWM
          make check
